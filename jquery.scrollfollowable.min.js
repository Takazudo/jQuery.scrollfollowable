/*! jQuery.scrollfollowable (https://github.com/Takazudo/jQuery.scrollfollowable)
 * lastupdate: 2014-09-30
 * version: 0.1.2
 * author: 'Takazudo' Takeshi Takatsudo <takazudo@gmail.com>
 * License: MIT */
(function(){var t=[].slice,i={}.hasOwnProperty,n=function(t,n){function e(){this.constructor=t}for(var r in n)i.call(n,r)&&(t[r]=n[r]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t},e=function(t,i){return function(){return t.apply(i,arguments)}};(function(i,r,o){var s,h,l;return h=i(r),s=i(o),l={},l.Event=function(){function i(){}return i.prototype.on=function(t,i){var n,e,r,o,s;for(null==this._callbacks&&(this._callbacks={}),n=t.split(" "),o=0,s=n.length;s>o;o++)e=n[o],(r=this._callbacks)[e]||(r[e]=[]),this._callbacks[e].push(i);return this},i.prototype.once=function(t,i){return this.on(t,function(){return this.off(t,arguments.callee),i.apply(this,arguments)}),this},i.prototype.trigger=function(){var i,n,e,r,o,s,h;if(i=arguments.length>=1?t.call(arguments,0):[],e=i.shift(),r=null!=(h=this._callbacks)?h[e]:void 0){for(o=0,s=r.length;s>o&&(n=r[o],n.apply(this,i)!==!1);o++);return this}},i.prototype.off=function(t,i){var n,e,r,o,s,h,l,a,c,u;if(!t)return this._callbacks={},this;for(e=t.split(" "),h=0,a=e.length;a>h;h++){if(s=e[h],o=null!=(u=this._callbacks)?u[s]:void 0,!o)return this;if(!i)return delete this._callbacks[s],this;for(r=l=0,c=o.length;c>l;r=++l)if(n=o[r],n===i){o=o.slice(),o.splice(r,1),this._callbacks[s]=o;break}}return this},i}(),l.calcTopFromView=function(t){return l.prepareWindow(),t.offset().top-h.scrollTop()},l.Window=function(t){function i(){this._eventify()}return n(i,t),i.prototype._eventify=function(){var t=this;return h.bind("resize orientationchange",function(){return t.trigger("resize")}),h.bind("scroll",function(){return t.trigger("scroll")}),this},i}(l.Event),l.prepareWindow=function(){return null!=l.window?this:(l.window=new l.Window,this)},l.HeightWatcher=function(t){function i(t){this.$el=t,this._lastHeight=this.$el.outerHeight(),this.tick()}return n(i,t),i.prototype.tick=function(){var t=this;return setTimeout(function(){return t.check(),t.tick()},250),this},i.prototype.check=function(){var t;return t=this.$el.outerHeight(),this._lastHeight!==t&&(this._lastHeight=t,this.trigger("changedetected")),this},i}(l.Event),l.Scrollfollowable=function(t){function r(t,n){this.$el=t,this.update=e(this.update,this),this.options=i.extend({},this.defaults,n),l.prepareWindow(),this._prepareEls(),this._rememberOriginalCss(),this._eventify(),this.update(),this.options.watchinnerheightchange&&this.startWatchingHeight()}return n(r,t),r.prototype.defaults={inner:"> *",holder:"body",mintopmargin:10,minbottommargin:10,keepholderheight:!0,originalcontainerheight:"auto",watchinnerheightchange:!1},r.prototype._prepareEls=function(){return this.$inner=this.$el.find(this.options.inner),this.$holder=s.find(this.options.holder),this},r.prototype._rememberOriginalCss=function(){return this._originalInnerCssProps={position:this.$inner.css("position"),top:this.$inner.css("top"),left:this.$inner.css("left")},this._originalContainerCssProps={height:this.options.originalcontainerheight},this},r.prototype._eventify=function(){return l.window.on("resize scroll",this.update),this},r.prototype.startWatchingHeight=function(){return this._heightWatcher=new l.HeightWatcher(this.$inner),this._heightWatcher.on("changedetected",this.update),this},r.prototype.isInnerOverHolder=function(){var t,i,n,e,r,o,s,l,a;return this.innerFixed?(e=this.$holder.offset().top,n=this.$holder.outerHeight(),t=e+n,l=this.options.mintopmargin,s=this.options.minbottommargin,a=h.scrollTop(),r=this.$inner.outerHeight(),o=a+l+r+s,i=t>o,this._innerOverAmount=i?null:o-t,!i):!0},r.prototype.update=function(){var t,i,n,e,r;return n=this.innerFixed,t=l.calcTopFromView(this.$el),e=this.options.mintopmargin,r=null,e>t?(this.innerFixed=!0,r={},n||(r.position="fixed"),this.fixContainerHeight(),r.top=this.isInnerOverHolder()?-this._innerOverAmount+e:e,i=this.$el.offset().left-h.scrollLeft(),this._lastInnerLeft!==i&&(r.left=i)):(this.innerFixed=!1,n===!0&&(r=this._originalInnerCssProps,this.unFixContainerHeight())),r&&this.anyInnerCssUpdated(r)&&(this.$inner.css(r),this.trigger("update"),this._lastInnerProps=r),this},r.prototype.fixContainerHeight=function(){return this.options.keepholderheight?(this.$el.height(this.$inner.outerHeight()),this):this},r.prototype.unFixContainerHeight=function(){return this.options.keepholderheight?(this.$el.css(this._originalContainerCssProps),this):this},r.prototype.anyInnerCssUpdated=function(t){var i,n,e,r,o,s;if(null==this._lastInnerProps)return!0;for(i=this._lastInnerProps,n=t,s=["position","top","left"],r=0,o=s.length;o>r;r++)if(e=s[r],i[e]!==n[e])return!0;return!1},r.prototype.destroy=function(){return l.window.off("resize scroll",this.update),this.$inner.css(this._originalInnerCssProps),this.unFixContainerHeight(),this.$el.data("scrollfollowable",null),this},r}(l.Event),function(){var t;return t="scrollfollowable",i.fn.scrollfollowable=function(n){return this.each(function(e,r){var o,s,h;return o=i(r),h=o.data(t),h&&h.destroy(),s=new l.Scrollfollowable(o,n),o.data(t,s),this})}}(),i.ScrollfollowableNs=l,i.Scrollfollowable=l.Scrollfollowable})(jQuery,window,document)}).call(this);