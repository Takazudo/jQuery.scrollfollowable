/*! jQuery.scrollfollowable (https://github.com/Takazudo/jQuery.scrollfollowable)
 * lastupdate: 2013-03-15
 * version: 0.0.0
 * author: 'Takazudo' Takeshi Takatsudo <takazudo@gmail.com>
 * License: MIT */
(function(){var t=[].slice,n={}.hasOwnProperty,i=function(t,i){function r(){this.constructor=t}for(var e in i)n.call(i,e)&&(t[e]=i[e]);return r.prototype=i.prototype,t.prototype=new r,t.__super__=i.prototype,t},r=function(t,n){return function(){return t.apply(n,arguments)}};(function(n,e,o){var s,l,h;return l=n(e),s=n(o),h={},h.Event=function(){function n(){}return n.prototype.on=function(t,n){var i,r,e,o,s;for(null==this._callbacks&&(this._callbacks={}),i=t.split(" "),o=0,s=i.length;s>o;o++)r=i[o],(e=this._callbacks)[r]||(e[r]=[]),this._callbacks[r].push(n);return this},n.prototype.once=function(t,n){return this.on(t,function(){return this.off(t,arguments.callee),n.apply(this,arguments)})},n.prototype.trigger=function(){var n,i,r,e,o,s,l;if(n=arguments.length>=1?t.call(arguments,0):[],r=n.shift(),e=null!=(l=this._callbacks)?l[r]:void 0){for(o=0,s=e.length;s>o&&(i=e[o],i.apply(this,n)!==!1);o++);return this}},n.prototype.off=function(t,n){var i,r,e,o,s,l,h,u,p,c;if(!t)return this._callbacks={},this;for(r=t.split(" "),l=0,u=r.length;u>l;l++){if(s=r[l],o=null!=(c=this._callbacks)?c[s]:void 0,!o)return this;if(!n)return delete this._callbacks[s],this;for(e=h=0,p=o.length;p>h;e=++h)if(i=o[e],i===n){o=o.slice(),o.splice(e,1),this._callbacks[s]=o;break}}return this},n}(),h.calcTopFromView=function(t){return h.prepareWindow(),t.offset().top-l.scrollTop()},h.Window=function(t){function n(){this._eventify()}return i(n,t),n.prototype._eventify=function(){var t=this;return l.on("resize orientationchange",function(){return t.trigger("resize")}),l.on("scroll",function(){return t.trigger("scroll")})},n}(h.Event),h.prepareWindow=function(){return null!=h.window?this:(h.window=new h.Window,this)},h.Scrollfollowable=function(t){function e(t,i){this.$el=t,this.update=r(this.update,this),this.options=n.extend({},this.defaults,i),h.prepareWindow(),this._prepareEls(),this._rememberOriginalCss(),this._eventify(),this.update()}return i(e,t),e.prototype.defaults={inner:"> *",holder:"body",mintopmargin:10,minbottommargin:10},e.prototype._prepareEls=function(){return this.$inner=this.$el.find(this.options.inner),this.$holder=s.find(this.options.holder),this},e.prototype._rememberOriginalCss=function(){return this._originalCssProps={position:this.$inner.css("position"),top:this.$inner.css("top"),left:this.$inner.css("left")},this},e.prototype._eventify=function(){return h.window.on("resize scroll",this.update),this},e.prototype.isInnerOverHolder=function(){var t,n,i,r,e,o,s,h,u;return this.innerFixed?(r=this.$holder.offset().top,i=this.$holder.outerHeight(),t=r+i,h=this.options.mintopmargin,s=this.options.minbottommargin,u=l.scrollTop(),e=this.$inner.outerHeight(),o=u+h+e+s,n=t>o,this._innerOverAmount=n?null:o-t,!n):!0},e.prototype.update=function(){var t,n,i,r,e;return i=this.innerFixed,t=h.calcTopFromView(this.$el),r=this.options.mintopmargin,e=null,r>t?(this.innerFixed=!0,e={},i||(e.position="fixed"),e.top=this.isInnerOverHolder()?-this._innerOverAmount:r,n=this.$el.offset().left-l.scrollLeft(),this._lastInnerLeft!==n&&(e.left=n)):(this.innerFixed=!1,i===!0&&(e=this._originalCssProps)),e&&this.$inner.css(e),this.trigger("update"),this},e.prototype.destroy=function(){return h.window.off("resize scroll",this.update),this.$inner.css(this._originalCssProps),this.$el.data("scrollfollowable",null),this},e}(h.Event),n.fn.scrollfollowable=function(t){return this.each(function(i,r){var e,o;return e=n(r),o=new h.Scrollfollowable(e,t),e.data("scrollfollowable",o),this})},n.ScrollfollowableNs=h})(jQuery,window,document)}).call(this);