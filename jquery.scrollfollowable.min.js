/*! jQuery.scrollfollowable (https://github.com/Takazudo/jQuery.scrollfollowable)
 * lastupdate: 2014-09-30
 * version: 0.1.4
 * author: 'Takazudo' Takeshi Takatsudo <takazudo@gmail.com>
 * License: MIT */
(function(){var t={}.hasOwnProperty,i=function(i,e){function n(){this.constructor=i}for(var r in e)t.call(e,r)&&(i[r]=e[r]);return n.prototype=e.prototype,i.prototype=new n,i.__super__=e.prototype,i},e=function(t,i){return function(){return t.apply(i,arguments)}};(function(t,n,r){var o,s,h,l;return s=t(n),o=t(r),h=n.EveEve,l={},l.calcTopFromView=function(t){return l.prepareWindow(),t.offset().top-s.scrollTop()},l.Window=function(t){function e(){this._eventify()}return i(e,t),e.prototype._eventify=function(){var t=this;return s.bind("resize orientationchange",function(){return t.trigger("resize")}),s.bind("scroll",function(){return t.trigger("scroll")}),this},e}(h),l.prepareWindow=function(){return null!=l.window?this:(l.window=new l.Window,this)},l.HeightWatcher=function(t){function e(t){this.$el=t,this._lastHeight=this.$el.outerHeight(),this.tick()}return i(e,t),e.prototype.tick=function(){var t=this;return setTimeout(function(){return t.check(),t.tick()},250),this},e.prototype.check=function(){var t;return t=this.$el.outerHeight(),this._lastHeight!==t&&(this._lastHeight=t,this.trigger("changedetected")),this},e}(h),l.Scrollfollowable=function(n){function r(i,n){this.$el=i,this.update=e(this.update,this),this.options=t.extend({},this.defaults,n),l.prepareWindow(),this._prepareEls(),this._rememberOriginalCss(),this._eventify(),this.update(),this.options.watchinnerheightchange&&this.startWatchingHeight()}return i(r,n),r.prototype.defaults={inner:"> *",holder:"body",mintopmargin:10,minbottommargin:10,keepholderheight:!0,originalcontainerheight:"auto",watchinnerheightchange:!1},r.prototype._prepareEls=function(){return this.$inner=this.$el.find(this.options.inner),this.$holder=o.find(this.options.holder),this},r.prototype._rememberOriginalCss=function(){return this._originalInnerCssProps={position:this.$inner.css("position"),top:this.$inner.css("top"),left:this.$inner.css("left")},this._originalContainerCssProps={height:this.options.originalcontainerheight},this},r.prototype._eventify=function(){return l.window.on("resize scroll",this.update),this},r.prototype.startWatchingHeight=function(){return this._heightWatcher=new l.HeightWatcher(this.$inner),this._heightWatcher.on("changedetected",this.update),this},r.prototype.isInnerOverHolder=function(){var t,i,e,n,r,o,h,l,a;return this.innerFixed?(n=this.$holder.offset().top,e=this.$holder.outerHeight(),t=n+e,l=this.options.mintopmargin,h=this.options.minbottommargin,a=s.scrollTop(),r=this.$inner.outerHeight(),o=a+l+r+h,i=t>o,this._innerOverAmount=i?null:o-t,!i):!0},r.prototype.update=function(){var t,i,e,n,r;return e=this.innerFixed,t=l.calcTopFromView(this.$el),n=this.options.mintopmargin,r=null,n>t?(this.innerFixed=!0,r={},e||(r.position="fixed"),this.fixContainerHeight(),r.top=this.isInnerOverHolder()?-this._innerOverAmount+n:n,i=this.$el.offset().left-s.scrollLeft(),this._lastInnerLeft!==i&&(r.left=i)):(this.innerFixed=!1,e===!0&&(r=this._originalInnerCssProps,this.unFixContainerHeight())),r&&this.anyInnerCssUpdated(r)&&(this.$inner.css(r),this.trigger("update"),this._lastInnerProps=r),this},r.prototype.fixContainerHeight=function(){return this.options.keepholderheight?(this.$el.height(this.$inner.outerHeight()),this):this},r.prototype.unFixContainerHeight=function(){return this.options.keepholderheight?(this.$el.css(this._originalContainerCssProps),this):this},r.prototype.anyInnerCssUpdated=function(t){var i,e,n,r,o,s;if(null==this._lastInnerProps)return!0;for(i=this._lastInnerProps,e=t,s=["position","top","left"],r=0,o=s.length;o>r;r++)if(n=s[r],i[n]!==e[n])return!0;return!1},r.prototype.destroy=function(){return l.window.off("resize scroll",this.update),this.$inner.css(this._originalInnerCssProps),this.unFixContainerHeight(),this.$el.data("scrollfollowable",null),this},r}(h),function(){var i;return i="scrollfollowable",t.fn.scrollfollowable=function(e){return this.each(function(n,r){var o,s,h;return o=t(r),h=o.data(i),h&&h.destroy(),s=new l.Scrollfollowable(o,e),o.data(i,s),this})}}(),t.ScrollfollowableNs=l,t.Scrollfollowable=l.Scrollfollowable})(jQuery,window,document)}).call(this);